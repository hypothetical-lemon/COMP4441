---
title: "COMP 4441 Final Project"
author: "Heather Lemon & Katie Chen"
date: "5/8/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#library(tidyverse)
library(dplyr)
library(ggplot2)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:
#load data
```{r}
person2020 = read.csv("./person2020.csv")
dat20=data.frame(person2020)


person2019 = read.csv("./person2019.csv")
dat19=data.frame(person2019)

```

# extract entities 
```{r}
state_name=dat$STATENAME
month_name=dat$MONTHNAME
day_name=dat$DAYNAME


# total car wreck deaths in 2019&2020
table_death_count2020=table(dat20$DOA)

total2020=table_death_count2020[2]+table_death_count2020[3]

table_death_count2019=table(dat19$DOA)
total2019=table_death_count2019[2]+table_death_count2019[3]

df2019=data.frame(total2019)
df2020=data.frame(total2020)

counts= c(df2019$total2019, df2020$total2020)
years = c('2019', '2020')

df=data.frame(years, counts)

ggplot(data=df, aes(x=years, y=counts))+geom_bar(stat = "identity", width = .3)+ggtitle("Fatality Count per Year")

```
V
```{r}

n19=table(dat19$MONTHNAME)
n19

df19=data.frame(n19)
df19

n20=table(dat20$MONTHNAME)
df20=data.frame(n20)
df20


ggplot(data = df19, aes(y=df19$Freq, x=df19$Var1))+geom_bar(stat = "identity", width = .3)+ggtitle("DEATH COUNT PER MONTH")
ggplot(data = df20, aes(y=df20$Freq, x=df20$Var1))+geom_bar(stat = "identity", width = .3)+ggtitle("DEATH COUNT PER MONTH")

```
# apply filters for unknown data 
```{r}
age_f<-data.frame(AGE=dat20$AGE[dat20$AGE<115])
ggplot(data=age_f, aes(x=AGE))+geom_bar(width=.5)+ggtitle("AGE 2020")

age_19<-data.frame(AGE=dat19$AGE[dat19$AGE<115])
ggplot(data=age_19, aes(x=AGE))+geom_bar(width=.5)+ggtitle("AGE 2019")
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

#Speeding Violations
```{r}
v2020=read.csv("./violatn2019.CSV")
v2019=read.csv("./violatn2020.CSV")


#speeding codes
viol_df2019=data.frame(table(v2019$VIOLATION))
speeding2019=viol_df2019$Freq[20]+viol_df2019$Freq[21]+viol_df2019$Freq[22]+viol_df2019$Freq[23]+viol_df2019$Freq[24]+viol_df2019$Freq[25]
speeding2019

viol_df2020=data.frame(table(v2020$MVIOLATN))
speeding2020=viol_df2020$Freq[20]+viol_df2020$Freq[21]+viol_df2020$Freq[22]+viol_df2020$Freq[23]+viol_df2020$Freq[24]+viol_df2020$Freq[25]
speeding2020

counts= c(speeding2019, speeding2020)
years = c('2019', '2020')

df=data.frame(years, counts)

ggplot(data=df, aes(x=years, y=counts))+geom_bar(stat = "identity", width = .3)+ggtitle("Speeding Count per Year")

```



#Accidents related to Alcohol 
```{r}
alc_df2019=data.frame(table(dat19$DRINKING))
alc_df2019$Freq[2]

alc_df2020=data.frame(table(dat20$DRINKING))
alc_df2020$Freq[2]

counts= c(alc_df2019$Freq[2], alc_df2020$Freq[2])
years = c('2019', '2020')

df_alc=data.frame(years, counts)

ggplot(data = df_alc, aes(x=years, y=counts))+geom_bar(stat = "identity", width = .3)+ggtitle("Alcohol Related Death Count")
```













